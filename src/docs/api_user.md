# 用户管理接口文档

## 接口列表

| 接口 | 方法 | 路径 | 权限 | 描述 |
|------|------|------|------|------|
| 创建用户 | POST | `/user/create` | 管理员/店主 | 创建新用户 |
| 更新用户 | PUT | `/user/update` | 管理员/店主 | 更新用户信息 |
| 获取用户列表 | GET | `/user/list` | 管理员/店主 | 分页获取用户列表 |
| 获取简单列表 | GET | `/user/simple-list` | 管理员/店主 | 获取简化用户列表 |
| 获取用户详情 | GET | `/user/detail` | 管理员/店主 | 获取单个用户详情 |
| 删除用户 | DELETE | `/user/delete` | 管理员/店主 | 删除用户 |
| 前台注册 | POST | `/user/register` | 公开 | 前台用户注册 |
| 前台登录 | POST | `/user/login` | 公开 | 前台用户登录 |
| 检查用户名 | GET | `/user/check-username` | 公开 | 检查用户名是否存在 |

**路径前缀**:
- 管理员: `/api/order-ease/v1/admin`
- 店主: `/api/order-ease/v1/shopOwner`
- 公开: `/api/order-ease/v1`

---

## 用户类型说明

| 类型 | 值 | 说明 |
|------|-----|------|
| 邮寄配送 | delivery | 商品邮寄到指定地址 |
| 门店自提 | pickup | 用户到门店自取商品 |

## 用户角色说明

| 角色 | 值 | 说明 |
|------|-----|------|
| 私有用户 | private | 由店主创建的用户 |
| 公开用户 | public | 通过前台注册的用户 |

---

## 1. 创建用户

**接口**: POST `/user/create`

**描述**: 创建新用户（管理员/店主创建）

**认证**: 需要

**请求参数**:

```json
{
  "name": "张三",
  "phone": "13800138000",
  "password": "pass123456",
  "address": "北京市朝阳区xxx街道",
  "type": "delivery",
  "role": "private"
}
```

**字段说明**:

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| name | string | 是 | 用户姓名，2-20字符 |
| phone | string | 是 | 手机号，11位 |
| password | string | 是 | 密码，6-20位，需包含字母和数字 |
| address | string | 否 | 收货地址 |
| type | string | 否 | 用户类型: delivery/pickup，默认delivery |
| role | string | 否 | 用户角色: private/public，默认private |

**成功响应**:

```json
{
  "code": 200,
  "data": {
    "id": 1234567890123456789,
    "name": "张三",
    "phone": "13800138000",
    "type": "delivery",
    "role": "private",
    "created_at": "2025-02-06T10:00:00Z"
  }
}
```

**错误响应**:

```json
{
  "code": 409,
  "error": "用户名已存在"
}
```

```json
{
  "code": 409,
  "error": "该手机号已注册"
}
```

```json
{
  "code": 400,
  "error": "密码长度必须在6-20位且包含字母和数字"
}
```

---

## 2. 更新用户

**接口**: PUT `/user/update`

**描述**: 更新用户信息

**认证**: 需要

**请求参数**:

```json
{
  "id": "1234567890123456789",
  "type": "pickup",
  "phone": "13900139000",
  "password": "newpass789",
  "address": "新地址",
  "role": "public"
}
```

**字段说明**:

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 用户ID |
| type | string | 否 | 用户类型: delivery/pickup |
| phone | string | 否 | 新手机号 |
| password | string | 否 | 新密码，6-20位，需包含字母和数字 |
| address | string | 否 | 新地址 |
| role | string | 否 | 用户角色: private/public |

**成功响应**:

```json
{
  "code": 200,
  "data": {
    "id": 1234567890123456789,
    "name": "张三",
    "phone": "13900139000",
    "address": "新地址",
    "type": "pickup",
    "role": "public",
    "created_at": "2025-02-06T10:00:00Z",
    "updated_at": "2025-02-06T12:00:00Z"
  }
}
```

**错误响应**:

```json
{
  "code": 400,
  "error": "无效的用户类型"
}
```

```json
{
  "code": 400,
  "error": "无效的角色"
}
```

```json
{
  "code": 409,
  "error": "该手机号已注册"
}
```

---

## 3. 获取用户列表

**接口**: GET `/user/list`

**描述**: 分页获取用户列表

**认证**: 需要

**查询参数**:

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | int | 否 | 1 | 页码 |
| pageSize | int | 否 | 10 | 每页数量 |
| search | string | 否 | - | 搜索关键词（用户名）|

**成功响应**:

```json
{
  "code": 200,
  "data": {
    "total": 100,
    "page": 1,
    "pageSize": 10,
    "data": [
      {
        "id": 1234567890123456789,
        "name": "张三",
        "phone": "13800138000",
        "address": "北京市朝阳区xxx街道",
        "type": "delivery",
        "role": "private",
        "created_at": "2025-02-06T10:00:00Z",
        "updated_at": "2025-02-06T10:00:00Z"
      }
    ]
  }
}
```

---

## 4. 获取简单用户列表

**接口**: GET `/user/simple-list`

**描述**: 获取简化用户列表，只返回ID和名称，用于下拉选择等场景

**认证**: 需要

**查询参数**:

| 参数 | 类型 | 必填 | 默认值 | 说明 |
|------|------|------|--------|------|
| page | int | 否 | 1 | 页码 |
| pageSize | int | 否 | 10 | 每页数量 |
| search | string | 否 | - | 搜索关键词（用户名）|

**成功响应**:

```json
{
  "code": 200,
  "data": {
    "total": 100,
    "page": 1,
    "pageSize": 10,
    "data": [
      {
        "id": 1234567890123456789,
        "name": "张三"
      },
      {
        "id": 1234567890123456790,
        "name": "李四"
      }
    ]
  }
}
```

---

## 5. 获取用户详情

**接口**: GET `/user/detail`

**描述**: 获取单个用户详情

**认证**: 需要

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 用户ID |

**成功响应**:

```json
{
  "code": 200,
  "data": {
    "id": 1234567890123456789,
    "name": "张三",
    "phone": "13800138000",
    "address": "北京市朝阳区xxx街道",
    "type": "delivery",
    "role": "private",
    "created_at": "2025-02-06T10:00:00Z",
    "updated_at": "2025-02-06T10:00:00Z"
  }
}
```

**错误响应**:

```json
{
  "code": 404,
  "error": "用户未找到"
}
```

---

## 6. 删除用户

**接口**: DELETE `/user/delete`

**描述**: 删除用户

**认证**: 需要

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| id | string | 是 | 用户ID |

**成功响应**:

```json
{
  "code": 200,
  "message": "用户删除成功"
}
```

**错误响应**:

```json
{
  "code": 404,
  "error": "用户不存在"
}
```

---

## 7. 前台用户注册

**接口**: POST `/user/register`

**描述**: 前台用户注册

**认证**: 公开（无需认证）

**请求参数**:

```json
{
  "username": "testuser",
  "password": "pass123456"
}
```

**字段说明**:

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| username | string | 是 | 用户名，2-20字符，唯一 |
| password | string | 是 | 密码，6-20位，需包含字母和数字 |

**成功响应**:

```json
{
  "code": 200,
  "message": "注册成功",
  "user": {
    "id": 1234567890123456789,
    "name": "testuser",
    "type": "pickup"
  }
}
```

**错误响应**:

```json
{
  "code": 409,
  "error": "用户名已存在"
}
```

```json
{
  "code": 400,
  "error": "密码必须为6-20位，且包含字母和数字"
}
```

---

## 8. 前台用户登录

**接口**: POST `/user/login`

**描述**: 前台用户登录

**认证**: 公开（无需认证）

**请求参数**:

```json
{
  "username": "testuser",
  "password": "pass123456"
}
```

**字段说明**:

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |

**成功响应**:

```json
{
  "code": 200,
  "message": "登录成功",
  "user": {
    "id": 1234567890123456789,
    "name": "testuser",
    "type": "pickup"
  },
  "token": "eyJhbGciOiJIUzI1NiIs...",
  "expiredAt": 1704067200
}
```

**错误响应**:

```json
{
  "code": 401,
  "error": "用户名或密码错误"
}
```

---

## 9. 检查用户名

**接口**: GET `/user/check-username`

**描述**: 检查用户名是否已存在

**认证**: 公开（无需认证）

**查询参数**:

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| username | string | 是 | 要检查的用户名 |

**成功响应**:

```json
{
  "code": 200,
  "exists": false
}
```

---

## 错误码汇总

| 状态码 | 错误信息 | 说明 |
|--------|----------|------|
| 400 | 无效的用户数据 | 请求参数缺失或格式错误 |
| 400 | 缺少用户ID | 未提供用户ID |
| 400 | 无效的用户类型 | type字段值错误 |
| 400 | 无效的角色 | role字段值错误 |
| 400 | 密码长度必须在6-20位且包含字母和数字 | 密码不符合要求 |
| 401 | 用户名或密码错误 | 登录凭据错误 |
| 404 | 用户未找到 | 用户ID不存在 |
| 404 | 用户不存在 | 删除时用户不存在 |
| 409 | 用户名已存在 | 用户名重复 |
| 409 | 该手机号已注册 | 手机号重复 |
| 500 | 创建用户失败 | 服务器内部错误 |
